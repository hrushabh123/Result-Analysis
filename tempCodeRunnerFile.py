CREATE OR REPLACE VIEW YEAR1 AS
        SELECT
            S.PASSYEAR,
            COUNT(DISTINCT S.STUDENTID) AS TotalStudents,
            COUNT(DISTINCT CASE WHEN R.YEAR = '1' AND NOT EXISTS (SELECT 1 FROM RESULT R2 WHERE R2.STUDENTID = R.STUDENTID AND (R2.GRADE = 'F' OR R2.SUPPLEMENTARY = 'YES')) THEN S.STUDENTID ELSE NULL END) AS year1,
            COUNT(DISTINCT CASE WHEN R.YEAR = '2' AND NOT EXISTS (SELECT 1 FROM RESULT R2 WHERE R2.STUDENTID = R.STUDENTID AND R2.YEAR <= '1' AND (R2.GRADE = 'F' OR R2.SUPPLEMENTARY = 'YES')) THEN S.STUDENTID ELSE NULL END) AS year2,
            COUNT(DISTINCT CASE WHEN R.YEAR = '3' AND NOT EXISTS (SELECT 1 FROM RESULT R2 WHERE R2.STUDENTID = R.STUDENTID AND R2.YEAR <= '2' AND (R2.GRADE = 'F' OR R2.SUPPLEMENTARY = 'YES')) THEN S.STUDENTID ELSE NULL END) AS year3,
            COUNT(DISTINCT CASE WHEN R.YEAR = '4' AND NOT EXISTS (SELECT 1 FROM RESULT R2 WHERE R2.STUDENTID = R.STUDENTID AND R2.YEAR <= '3' AND (R2.GRADE = 'F' OR R2.SUPPLEMENTARY = 'YES')) THEN S.STUDENTID ELSE NULL END) AS year4

        FROM
            STUDENT S
        JOIN
            RESULT R ON S.STUDENTID = R.STUDENTID
        GROUP BY
            S.PASSYEAR;